# 1.6 比特币的原理-共识机制

上一节我们讲到比特币通过工作量证明机制来选定唯一记账人来完成记账。那么问题来了，
**如果两个节点同时完成工作量证明，那么使用谁的区块？**

在比特币里是没有中心化的仲裁机构的，如果有，那么有仲裁机构来裁决就好了。两个打包的区块的旷工都会要求用自己打包的区块，那么旷工直接如何达成共识，让大家都去认可，到底用谁打包的区块。
这一节我们来解决这个问题。区块链里面把解决这个问题的方法就是共识机制。共识机制就是大家共同遵守的一套协议。

* #### 为什么要遵守协议
为什么要遵守协议呢，可不可以各用各的，这其实是一个经济问题。在经济生活中呢，每个人追求的利益最大化，节点工作量只有在其他的节点认同其是有效的，因为打包的新的区块需要得到其他节点的验证，通过之后才会加入到区块链之中，并且在网络上传播，才会因此获得收益。而只有遵守规则，才会得到其他节点的认同。因此所有节点都要遵守协议。


* #### 累积工作量最大的区块
还是回到如何达成共识这个问题上来，如果两个节点同时完成了工作量证明怎么办呢？其实这个共识很简单，每个节点只认可累积工作量最大的区块链，或者难度最大的一条链，这条链会被大家都认可，会成为最终权威的总账本。
需要注意的是，每个节点的行为都是**独立**的，他们去独立的进行选择，总是选择一条工作量最大的区块链最大的区块链去挖矿，来**延长这条最长的链**。

* #### 分叉
我们来实际分析一下这个场景。
> 先进行定义，将累计最大的难度（包含最多区块）的链成为主链

    当两名旷工几乎同时，各自求得了工作量证明的解，打出了两个包，一个是#3458A，一个是#3458B，这两个节点是求解出答案之后，他们会立刻在网络上进行广播，先广播至临近的节点，在循环扩算。





